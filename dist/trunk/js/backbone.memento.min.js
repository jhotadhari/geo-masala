Backbone.Memento=function(a,b){"use strict";var c=function(b){b instanceof a.Model?(this.removeAttr=function(a){b.unset(a)},this.restore=function(a){b.set(a)}):(this.removeAttr=function(a){b.remove(a)},this.restore=function(a){b.reset(a)})},d=function(a,d){function e(a,c){if(a=b.clone(a),c.hasOwnProperty("ignore")&&c.ignore.length>0)for(var d in c.ignore){var e=c.ignore[d];delete a[e]}return a}function f(a,b){var c=[];if(!a||!b)return c;for(var d in b)b.hasOwnProperty(d)&&(a.hasOwnProperty(d)||c.push(d));return c}function g(a,b){for(var c in b){var d=b[c];i.removeAttr(d)}}function h(b,c){var d=e(b,c),h=a.toJSON();h=e(h,c);var j=f(d,h);g(a,j),i.restore(d)}var i=new c(a);this.serialize=function(){var b=a.toJSON();return b=e(b,d)},this.deserialize=function(a,c){c=b.extend({},d,c),h(a,c)}},e=function(a,b){function c(){d=[]}var d;this.push=function(a){d.push(a)},this.pop=function(a){return d.pop()},this.rewind=function(){var a=d[0];return c(),a},c()};return function(a,c){this.version="0.4.1a",c=b.extend({ignore:[]},c);var f=new d(a,c),g=new e(a,c),h=function(a,b){a&&f.deserialize(a,b)};this.store=function(){var a=f.serialize();g.push(a)},this.restore=function(a){var b=g.pop();h(b,a)},this.restart=function(a){var b=g.rewind();h(b,a)}}}(Backbone,_);